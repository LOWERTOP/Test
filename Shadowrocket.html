<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Shadowrocket ä¸»é¢˜å¯è§†åŒ–ç¼–è¾‘å™¨ â€” iPhone 17 Pro Max / iOS 26</title>
<style>
  :root{
    --NavigationBarColor: rgba(0,0,0,0.0);
    --NavigationBar2Color: rgba(0,0,0,0.0);
    --NavigationBarTextColor: #ADBBC8;
    --NavigationBar2TextColor: #2473BD;
    --TabBarColor: rgba(0,0,0,0.0);
    --TabBarBorderColor: rgba(0,0,0,0.0);
    --TabBarSelectedColor: #2473BD;
    --TabBarUnselectedColor: #ADBBC8;
    --TableBackgroundColor: #181E26;
    --TableCellBackgroundColor: #202935;
    --TableCellSelectedBackgroundColor: #181E26;
    --TableSeparatorColor: #181E26;
    --TextFieldTextColor: #ADBBC8;
    --PlaceholderColor: #ADBBC8;
    --TextLabelTextColor: #ADBBC8;
    --DetailLabelTextColor: #4F6077;
    --TextLabelDeleteColor: #2473BD;
    --HeaderFooterTextColor: #4F6077;
    --SearchFieldBackgroundColor: #202935;
    --IndicatorColor: #ADBBC8;
    --ButtonIconColor: #2473BD;
    --ButtonNormalColor: #ADBBC8;
    --ButtonHighlightedColor: #ADBBC8;
    --ButtonDisabledColor: #ADBBC8;
    --PingSuccessTextColor: #2473BD;
    --PingTimeoutTextColor: #4F6077;
    --DefaultDotColor: #2473BD;
    --HUDBackgroundColor: #202935;

    --glass-strong: rgba(255,255,255,0.06);
    --glass-weak: rgba(255,255,255,0.03);
    --frame: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.3));
    --font-main: -apple-system, "SF Pro Text", "Helvetica Neue", Arial, sans-serif;
  }

  html,body{height:100%;margin:0;font-family:var(--font-main);background:linear-gradient(180deg,#051937 0%, #0f3d63 50%);color:#fff;-webkit-font-smoothing:antialiased;}
  .container{width:95%;max-width:1400px;margin:24px auto;display:flex;gap:28px;align-items:flex-start;}
  /* å·¦ä¾§é¢æ¿ */
  .panel{
    flex:1;
    min-width:320px;
    max-width:640px;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:18px;
    padding:18px;
    backdrop-filter: blur(18px) saturate(1.1);
    -webkit-backdrop-filter: blur(18px) saturate(1.1);
    border:1px solid rgba(255,255,255,0.06);
    box-shadow: 0 10px 40px rgba(0,0,0,0.45);
  }
  .panel h2{margin:0 0 6px 0;font-weight:600;}
  .panel p.desc{margin:0;color:rgba(255,255,255,0.65);font-size:13px;}
  .controls{margin-top:14px;max-height:70vh;overflow:auto;padding-right:6px;}
  .control-row{display:grid;grid-template-columns:1fr 160px;gap:12px;align-items:center;padding:8px;border-radius:10px;margin-bottom:10px;background:linear-gradient(180deg, rgba(0,0,0,0.06), rgba(255,255,255,0.01));}
  .control-row label{font-size:13px;color:#E6EEF8;}
  .color-wrap{display:flex;gap:8px;align-items:center;}
  .color-input{width:44px;height:34px;border-radius:8px;border:1px solid rgba(0,0,0,0.2);overflow:hidden;padding:0;background:#000;}
  input[type="color"]{width:100%;height:100%;border:0;padding:0;background:transparent;cursor:pointer;}
  .alpha{display:flex;align-items:center;gap:8px;}
  input[type="range"]{width:100%;}
  .small{font-size:12px;color:rgba(255,255,255,0.7)}
  .actions{display:flex;gap:10px;margin-top:16px;}
  button{padding:10px 12px;border-radius:10px;border:0;cursor:pointer;font-weight:600}
  .btn-primary{background:linear-gradient(90deg,#2A76F6,#3AB0D6);color:white}
  .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.08);color:white}
  textarea{width:100%;height:86px;border-radius:8px;background:rgba(0,0,0,0.2);border:1px solid rgba(255,255,255,0.04);color:#fff;padding:8px;margin-top:12px;resize:vertical}

  /* å³ä¾§è®¾å¤‡ */
  .device{
    width:420px; /* è¿‘ä¼¼ iPhone 17 Pro Max è§†è§‰å¤§å° */
    display:flex;flex-direction:column;align-items:center;gap:14px;
  }

  .device-frame{
    width:420px;height:920px;border-radius:56px;padding:14px;background:linear-gradient(180deg, #0b0b0b, #0e0e10);
    position:relative;box-shadow:0 40px 80px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
    border:3px solid rgba(255,255,255,0.04);overflow:hidden;transform:translateZ(0);
  }

  /* åŠ¨æ€å²›/æ‘„åƒå¤´æ¡ */
  .dynamic-island{position:absolute;left:50%;top:14px;transform:translateX(-50%);width:150px;height:36px;border-radius:20px;background:rgba(0,0,0,0.6);backdrop-filter: blur(8px);-webkit-backdrop-filter: blur(8px);z-index:50;box-shadow:0 4px 12px rgba(0,0,0,0.6);}

  /* å±å¹• */
  .screen{
    position:relative;left:12px;right:12px;top:64px;bottom:18px;height:calc(100% - 120px);
    border-radius:28px;overflow:hidden;background:var(--TableBackgroundColor);
    display:flex;flex-direction:column;box-shadow:inset 0 1px 0 rgba(255,255,255,0.02);
  }

  /* iOS æ¯›ç»ç’ƒé¡¶éƒ¨ */
  .nav{
    padding:18px 16px 10px 16px;display:flex;align-items:center;justify-content:space-between;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.00));
    backdrop-filter: blur(12px) saturate(1.05);
    -webkit-backdrop-filter: blur(12px) saturate(1.05);
    color:var(--NavigationBarTextColor);
  }
  .nav h1{margin:0;font-size:22px;font-weight:700}
  .nav .right{display:flex;gap:10px;align-items:center}
  .nav .icon{font-size:20px;color:var(--ButtonIconColor)}

  .content{padding:14px;overflow:auto;flex:1}
  .card{
    border-radius:16px;padding:14px;margin-bottom:16px;background:linear-gradient(135deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));
    box-shadow:0 8px 24px rgba(0,0,0,0.28);position:relative;backdrop-filter: blur(10px);
  }
  .card .title{font-weight:700;font-size:18px;color:var(--TextLabelTextColor)}
  .card .sub{font-size:13px;color:var(--DetailLabelTextColor);margin-top:6px}

  .section-title{font-size:12px;color:var(--HeaderFooterTextColor);letter-spacing:0.6px;margin:6px 12px;font-weight:600}

  .list{
    background:var(--TableCellBackgroundColor);border-radius:12px;padding:6px;overflow:hidden;margin-bottom:18px;
  }

  .row{
    display:flex;align-items:center;gap:12px;padding:12px;border-bottom:1px solid var(--TableSeparatorColor);cursor:pointer;
  }
  .row:last-child{border-bottom:0}
  .icon-box{width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center;background:var(--ButtonIconColor);color:#fff;font-weight:700}
  .row .meta{flex:1}
  .row .meta .t{color:var(--TextLabelTextColor);font-weight:600}
  .row .meta .d{color:var(--DetailLabelTextColor);font-size:12px;margin-top:4px}
  .ping{font-weight:700;color:var(--PingSuccessTextColor);}

  /* TabBar */
  .tab{
    height:86px;background:var(--TabBarColor);display:flex;justify-content:space-around;align-items:flex-start;padding-top:14px;border-top:1px solid var(--TabBarBorderColor);
    backdrop-filter: blur(12px);-webkit-backdrop-filter: blur(12px);
  }
  .tab .item{display:flex;flex-direction:column;align-items:center;font-size:11px;color:var(--TabBarUnselectedColor);gap:6px}
  .tab .item.active{color:var(--TabBarSelectedColor)}

  .home-indicator{position:absolute;left:50%;transform:translateX(-50%);bottom:10px;width:120px;height:5px;border-radius:999px;background:rgba(255,255,255,0.12)}

  /* footer note */
  .note{font-size:12px;color:rgba(255,255,255,0.6);margin-top:6px}

  /* å†…éƒ¨æ»šåŠ¨æ¡ç®€æ´ */
  .controls::-webkit-scrollbar,.content::-webkit-scrollbar{width:8px;height:8px}
  .controls::-webkit-scrollbar-thumb,.content::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.06);border-radius:8px}
  @media (max-width:1100px){.container{flex-direction:column;align-items:center}.device{width:360px}.device-frame{width:360px;height:820px}}
</style>
</head>
<body>
<div class="container">
  <!-- å·¦ä¾§ï¼šç¼–è¾‘å™¨ -->
  <div class="panel">
    <h2>Shadowrocket é…è‰²ç¼–è¾‘å™¨</h2>
    <p class="desc">ç›®æ ‡è®¾å¤‡ï¼šiPhone 17 Pro Max Â· iOS 26 é£æ ¼ï¼ˆæ¶²æ€æ¯›ç»ç’ƒï¼‰ã€‚ä¿®æ”¹é¢œè‰²åå³ä¾§æ¨¡æ‹Ÿå™¨å³æ—¶é¢„è§ˆã€‚æ”¯æŒå¯¼å…¥/å¯¼å‡º Shadowrocket é…è‰²é“¾æ¥ã€‚</p>

    <div class="controls" id="controls"></div>

    <div style="margin-top:8px;">
      <textarea id="urlArea" placeholder="åœ¨æ­¤ç²˜è´´æˆ–æŸ¥çœ‹ shadowrocket://color?... é…è‰²é“¾æ¥"></textarea>
      <div class="actions">
        <button class="btn-ghost" id="btnImport">å¯¼å…¥é…è‰²åœ°å€</button>
        <button class="btn-ghost" id="btnJSONImport">ä» JSON å¯¼å…¥</button>
        <button class="btn-primary" id="btnExport">ç”Ÿæˆå¹¶å¤åˆ¶é…è‰²åœ°å€</button>
      </div>
      <div style="display:flex;gap:8px;margin-top:10px;">
        <button class="btn-ghost" id="btnExportJSON">å¯¼å‡º JSON æ–‡ä»¶</button>
        <button class="btn-ghost" id="btnReset">é‡ç½®é»˜è®¤</button>
      </div>
      <div class="note">ç¤ºä¾‹é“¾æ¥å·²åœ¨é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨å¡«å……ã€‚æ”¯æŒ #AARRGGBB ä¸ #RRGGBB ä¸¤ç§æ ¼å¼ã€‚</div>
    </div>
  </div>

  <!-- å³ä¾§ï¼šè®¾å¤‡é¢„è§ˆ -->
  <div class="device">
    <div style="font-size:13px;color:rgba(255,255,255,0.9)">iPhone 17 Pro Max æ¨¡æ‹Ÿå™¨</div>
    <div class="device-frame" role="img" aria-label="iPhone 17 Pro Max">
      <div class="dynamic-island"></div>
      <div class="screen" id="screen">
        <div class="nav" id="nav">
          <h1>Shadowrocket</h1>
          <div class="right">
            <div class="icon">ï¼‹</div>
            <div class="icon">â‹¯</div>
          </div>
        </div>

        <div class="content">
          <div class="card">
            <div class="title">Not Connected</div>
            <div class="sub">Click to connect</div>
            <div style="position:absolute;right:16px;top:18px;">
              <div id="switch" style="width:52px;height:30px;border-radius:20px;background:rgba(255,255,255,0.12);position:relative;box-shadow:inset 0 1px 0 rgba(255,255,255,0.02)"></div>
            </div>
          </div>

          <div class="section-title">Global Routing</div>
          <div class="list">
            <div class="row"><div class="meta"><div class="t">Config</div><div class="d">default.conf</div></div><div class="meta" style="text-align:right;color:var(--DetailLabelTextColor)">â€º</div></div>
            <div class="row"><div class="meta"><div class="t">Proxy</div><div class="d">Direct Connect</div></div><div class="meta" style="text-align:right;color:var(--DetailLabelTextColor)">â€º</div></div>
          </div>

          <div class="section-title">Servers</div>
          <div class="list">
            <div class="row">
              <div class="icon-box">ğŸ‡ºğŸ‡¸</div>
              <div class="meta"><div class="t">US - Los Angeles 01</div><div class="d">vmess â€¢ 23ms</div></div>
              <div class="ping">23 ms</div>
            </div>

            <div class="row" style="background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.05))">
              <div class="icon-box">ğŸ‡¯ğŸ‡µ</div>
              <div class="meta"><div class="t">JP - Tokyo Premium</div><div class="d">trojan â€¢ 45ms</div></div>
              <div class="ping" style="color:var(--PingTimeoutTextColor)">45 ms</div>
            </div>

            <div class="row">
              <div class="icon-box">ğŸ‡¸ğŸ‡¬</div>
              <div class="meta"><div class="t">SG - Singapore</div><div class="d">ss â€¢ Timeout</div></div>
              <div class="ping" style="color:var(--PingTimeoutTextColor)">Timeout</div>
            </div>
          </div>
        </div>

        <div class="tab">
          <div class="item active"><div>ğŸ </div><div>é¦–é¡µ</div></div>
          <div class="item"><div>ğŸ“</div><div>é…ç½®</div></div>
          <div class="item"><div>ğŸ“Š</div><div>æ•°æ®</div></div>
          <div class="item"><div>âš™ï¸</div><div>è®¾ç½®</div></div>
        </div>

        <div class="home-indicator"></div>
      </div>
    </div>
  </div>
</div>

<script>
/*
  åŠŸèƒ½è¦ç‚¹ï¼š
  - colorKeys åˆ—è¡¨æ˜¯ Shadowrocket æ”¯æŒçš„é¢œè‰²é¡¹ï¼ˆå¯æŒ‰éœ€å¢åˆ ï¼‰
  - æ”¯æŒå¯¼å…¥ï¼šè§£æ shadowrocket://color?... å‚æ•°ï¼ˆåŒ…æ‹¬ %23AARRGGBBï¼‰
  - æ”¯æŒå¯¼å‡ºï¼šå°† #RRGGBB æˆ– #RRGGBBAA è½¬ä¸º %23AARRGGBBï¼ˆæŒ‰ç…§ Shadowrocket åŸå§‹æ ¼å¼ AARRGGBBï¼‰
  - æ”¯æŒ alpha ç¼–è¾‘ï¼ˆé¡µé¢ä½¿ç”¨ rgba CSS å˜é‡ï¼Œè¾“å…¥åŒºä»ä»¥ hex ä¸ºä¸»å¹¶æä¾› alpha sliderï¼‰
*/

const colorKeys = [
"NavigationBarColor","NavigationBar2Color","NavigationBarTextColor","NavigationBar2TextColor",
"TabBarColor","TabBarBorderColor","TabBarSelectedColor","TabBarUnselectedColor",
"TableBackgroundColor","TableCellBackgroundColor","TableCellSelectedBackgroundColor","TableSeparatorColor",
"TextFieldTextColor","PlaceholderColor","TextLabelTextColor","DetailLabelTextColor","TextLabelDeleteColor",
"HeaderFooterTextColor","SearchFieldBackgroundColor","IndicatorColor","ButtonIconColor","ButtonNormalColor",
"ButtonHighlightedColor","ButtonDisabledColor","PingSuccessTextColor","PingTimeoutTextColor","DefaultDotColor","HUDBackgroundColor"
];

// çŠ¶æ€ï¼šä¿å­˜ä¸º {key: {hex:'#RRGGBB', alpha:0-1}} æ ¼å¼
let state = {};

// å·¥å…·å‡½æ•°ï¼šæ ¼å¼è½¬æ¢
function pad2(v){ return v.length===1 ? '0'+v : v; }
function clamp01(v){ return Math.max(0, Math.min(1, v)); }

// å°† Shadowrocket çš„ #AARRGGBB æˆ– #RRGGBB è½¬ä¸º {hex:'#RRGGBB', alpha:0-1}
function parseSrHex(sr){
  if(!sr) return {hex:'#000000', alpha:1};
  sr = sr.trim();
  if(sr.startsWith('%23')) sr = decodeURIComponent(sr);
  if(sr.startsWith('#')) sr = sr.slice(1);
  // sr ç°åœ¨å¯èƒ½æ˜¯ AARRGGBB æˆ– RRGGBB
  if(sr.length === 8){
    const aa = sr.slice(0,2);
    const rrggbb = sr.slice(2);
    const alpha = parseInt(aa,16)/255;
    return {hex:'#'+rrggbb.toUpperCase(), alpha: clamp01(alpha)};
  } else if(sr.length === 6){
    return {hex:'#'+sr.toUpperCase(), alpha:1};
  }
  // å›é€€
  return {hex:'#000000', alpha:1};
}

// å°† {hex:'#RRGGBB', alpha} è½¬ä¸º Shadowrocket çš„ %23AARRGGBB æ ¼å¼
function toSrParam(obj){
  let hex = (obj.hex || '#000000').replace('#','').toUpperCase();
  let alpha = Math.round((typeof obj.alpha === 'number' ? clamp01(obj.alpha) : 1)*255);
  let aa = pad2(alpha.toString(16).toUpperCase());
  // AARRGGBB
  return '%23' + aa + hex;
}

// CSS rgba å­—ç¬¦ä¸² from state
function rgbaFrom(obj){
  const h = obj.hex.replace('#','');
  const r = parseInt(h.slice(0,2),16);
  const g = parseInt(h.slice(2,4),16);
  const b = parseInt(h.slice(4,6),16);
  return `rgba(${r}, ${g}, ${b}, ${clamp01(obj.alpha)})`;
}

// åˆå§‹åŒ–æ§ä»¶
const controls = document.getElementById('controls');
colorKeys.forEach(key=>{
  // åˆå§‹åŒ–é»˜è®¤ stateï¼ˆä» CSS å˜é‡è¯»å–ï¼‰
  const computed = getComputedStyle(document.documentElement).getPropertyValue('--'+key).trim();
  let parsed = {hex:'#000000', alpha:1};
  if(computed){
    // å°è¯•è§£æ rgba / hex
    if(computed.startsWith('rgba') || computed.startsWith('rgb')){
      // e.g. rgba(r,g,b,a)
      const m = computed.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([0-9.]+))?\)/);
      if(m){
        const r=parseInt(m[1]), g=parseInt(m[2]), b=parseInt(m[3]), a= m[4]?parseFloat(m[4]):1;
        parsed = {hex:'#'+[r,g,b].map(x=>x.toString(16).padStart(2,'0')).join('').toUpperCase(), alpha: a};
      }
    } else {
      // hex like #RRGGBB or #RRGGBBAA (rare)
      parsed = parseSrHex(computed);
      // if parseSrHex returned alpha as 1 and computed may be #RRGGBB
    }
  }
  state[key] = parsed;

  const row = document.createElement('div');
  row.className = 'control-row';
  row.innerHTML = `
    <div>
      <label>${key}</label>
      <div class="small" style="margin-top:6px;color:rgba(255,255,255,0.6)">${key}</div>
    </div>
    <div style="display:flex;gap:8px;align-items:center;">
      <div class="color-wrap" style="flex:0 0 64px;">
        <div class="color-input"><input type="color" id="c_${key}" value="${parsed.hex}"></div>
        <div style="width:70px;">
          <input type="text" id="t_${key}" value="${parsed.hex}" style="width:100%;border-radius:8px;border:1px solid rgba(255,255,255,0.06);padding:6px;background:transparent;color:#fff" />
        </div>
      </div>
      <div style="flex:1">
        <div class="alpha">
          <input type="range" id="a_${key}" min="0" max="100" value="${Math.round(parsed.alpha*100)}">
        </div>
        <div class="small" style="text-align:right;margin-top:6px;color:rgba(255,255,255,0.55)">Alpha: <span id="aval_${key}">${Math.round(parsed.alpha*100)}%</span></div>
      </div>
    </div>
  `;
  controls.appendChild(row);

  // ç»‘å®šäº‹ä»¶
  const c = row.querySelector(`#c_${key}`);
  const t = row.querySelector(`#t_${key}`);
  const a = row.querySelector(`#a_${key}`);
  const aval = row.querySelector(`#aval_${key}`);

  c.addEventListener('input', e => {
    const v = e.target.value.toUpperCase();
    t.value = v;
    state[key].hex = v;
    updateVar(key);
  });

  t.addEventListener('change', e=>{
    let v = e.target.value.trim();
    if(!v.startsWith('#')) v = '#'+v;
    // ç®€å•æ ¡éªŒ6ä½ hex
    if(/^#([0-9A-Fa-f]{6})$/.test(v)){
      state[key].hex = v.toUpperCase();
      const input = row.querySelector(`#c_${key}`);
      if(input) input.value = state[key].hex;
      updateVar(key);
    } else {
      // revert
      e.target.value = state[key].hex;
    }
  });

  a.addEventListener('input', e=>{
    const val = clamp01(e.target.value/100);
    state[key].alpha = val;
    aval.textContent = Math.round(val*100) + '%';
    updateVar(key);
  });

});

// æ›´æ–° CSS å˜é‡å¹¶åˆ·æ–°é¡µé¢ä¸Šçš„å…ƒç´ 
function updateVar(key){
  const obj = state[key];
  const rgba = rgbaFrom(obj);
  document.documentElement.style.setProperty('--' + key, rgba);
  // special-case some places that use text color / icon color: also update inline if needed
  // ä¾‹å¦‚ nav æ–‡æœ¬ç­‰ï¼ˆCSS å·²ä½¿ç”¨å˜é‡ï¼Œæ‰€ä»¥ç›´æ¥æ”¹å˜å˜é‡å³å¯ï¼‰
}

// å¯¼å…¥ Shadowrocket é“¾æ¥
function importFromUrl(url){
  if(!url || !url.includes('shadowrocket://color')){ alert('ä¸æ˜¯æœ‰æ•ˆçš„ shadowrocket://color é“¾æ¥'); return; }
  const q = url.split('?')[1] || '';
  const params = new URLSearchParams(q);
  params.forEach((value, key)=>{
    if(colorKeys.includes(key)){
      const parsed = parseSrHex(value);
      state[key] = parsed;
      // æ›´æ–° inputs
      const txt = document.getElementById('t_'+key);
      const col = document.getElementById('c_'+key);
      const al = document.getElementById('a_'+key);
      if(txt) txt.value = parsed.hex;
      if(col) col.value = parsed.hex;
      if(al) al.value = Math.round(parsed.alpha*100);
      const aval = document.getElementById('aval_'+key);
      if(aval) aval.textContent = Math.round(parsed.alpha*100) + '%';
      updateVar(key);
    }
  });
  // å°† urlArea è®¾ç½®ä¸ºè¯¥é“¾æ¥ï¼ˆä¿æŒå¯è§ï¼‰
  document.getElementById('urlArea').value = url;
  alert('é…è‰²å·²å¯¼å…¥å¹¶åº”ç”¨åˆ°é¢„è§ˆã€‚');
}

// ç”Ÿæˆ Shadowrocket é“¾æ¥
function generateUrl(){
  const base = 'shadowrocket://color?';
  let pairs = [];
  colorKeys.forEach(k=>{
    const obj = state[k];
    if(obj && obj.hex){
      // to sr param
      pairs.push(`${k}=${toSrParam(obj)}`);
    }
  });
  pairs.push('v=1.0');
  return base + pairs.join('&');
}

// é¡µé¢åŠ è½½æ—¶å¡«å……ç¤ºä¾‹é“¾æ¥å¹¶å¯¼å…¥
const sample = "shadowrocket://color?NavigationBarColor=%2300FFFFFF&NavigationBar2Color=%2300FFFFFF&NavigationBarTextColor=%23ADBBC8&NavigationBar2TextColor=%232473BD&TabBarColor=%2300FFFFFF&TabBarBorderColor=%2300000000&TabBarSelectedColor=%232473BD&TabBarUnselectedColor=%23ADBBC8&TableBackgroundColor=%23181E26&TableCellBackgroundColor=%23202935&TableCellSelectedBackgroundColor=%23181E26&TableSeparatorColor=%23181E26&TextFieldTextColor=%23ADBBC8&PlaceholderColor=%23ADBBC8&TextLabelTextColor=%23ADBBC8&DetailLabelTextColor=%234F6077&TextLabelDeleteColor=%232473BD&HeaderFooterTextColor=%234F6077&SearchFieldBackgroundColor=%23202935&IndicatorColor=%23ADBBC8&ButtonIconColor=%232473BD&ButtonNormalColor=%23ADBBC8&ButtonHighlightedColor=%23ADBBC8&ButtonDisabledColor=%23ADBBC8&PingSuccessTextColor=%232473BD&PingTimeoutTextColor=%234F6077&DefaultDotColor=%232473BD&HUDBackgroundColor=%23202935&v=1.0";

// ç»‘å®šæŒ‰é’®
document.getElementById('btnImport').addEventListener('click', ()=>{
  const url = document.getElementById('urlArea').value.trim();
  importFromUrl(url);
});

document.getElementById('btnExport').addEventListener('click', ()=>{
  const url = generateUrl();
  document.getElementById('urlArea').value = url;
  // å¤åˆ¶åˆ°å‰ªè´´æ¿
  navigator.clipboard.writeText(url).then(()=>{ alert('é…è‰²é“¾æ¥å·²ç”Ÿæˆå¹¶å¤åˆ¶åˆ°å‰ªè´´æ¿'); }).catch(()=>{ alert('ç”ŸæˆæˆåŠŸï¼Œä½†å¤åˆ¶åˆ°å‰ªè´´æ¿å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶æ–‡æœ¬æ¡†å†…å®¹ã€‚'); });
});

document.getElementById('btnExportJSON').addEventListener('click', ()=>{
  const json = {};
  colorKeys.forEach(k => json[k] = {...state[k]});
  const blob = new Blob([JSON.stringify(json,null,2)], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'shadowrocket-theme.json'; a.click();
  URL.revokeObjectURL(url);
});

document.getElementById('btnJSONImport').addEventListener('click', ()=>{
  const area = document.getElementById('urlArea');
  try{
    const j = JSON.parse(area.value);
    for(const k in j){
      if(colorKeys.includes(k) && j[k] && j[k].hex){
        state[k] = {hex: j[k].hex.toUpperCase(), alpha: clamp01(j[k].alpha)};
        const t = document.getElementById('t_'+k), c = document.getElementById('c_'+k), a = document.getElementById('a_'+k), aval = document.getElementById('aval_'+k);
        if(t) t.value = state[k].hex;
        if(c) c.value = state[k].hex;
        if(a) a.value = Math.round(state[k].alpha*100);
        if(aval) aval.textContent = Math.round(state[k].alpha*100) + '%';
        updateVar(k);
      }
    }
    alert('å·²ä» JSON å¯¼å…¥å¹¶åº”ç”¨ã€‚');
  }catch(e){
    alert('è§£æ JSON å¤±è´¥ï¼Œè¯·ç¡®ä¿æ–‡æœ¬åŒºåŸŸå†…ä¸ºåˆæ³• JSONã€‚');
  }
});

// é‡ç½®é»˜è®¤
document.getElementById('btnReset').addEventListener('click', ()=>{
  if(!confirm('é‡ç½®ä¸ºå†…ç½®ç¤ºä¾‹é…è‰²ï¼Ÿ')) return;
  document.getElementById('urlArea').value = sample;
  importFromUrl(sample);
});

// é¡µé¢åŠ è½½é»˜è®¤ç¤ºä¾‹
window.addEventListener('load', ()=>{
  document.getElementById('urlArea').value = sample;
  importFromUrl(sample);
});
</script>
</body>
</html>
