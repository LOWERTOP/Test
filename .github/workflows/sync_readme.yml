name: Sync README.md Between Branches

on:
  push:
    branches:
      - main
      - README  # 监听 README 分支的变更
  workflow_dispatch:  # 允许手动触发

jobs:
  sync-readme:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Set up Git
        run: |
          git config --global user.name "github-actions"
          git config --global user.email "github-actions@github.com"

      - name: Sync README.md
        run: |
          git checkout main
          cp README.md /tmp/README.md
          git checkout README
          mv /tmp/README.md README.md
          git commit -am "Sync README.md from main to README" || echo "No changes to commit"
          git push origin README
          
          git checkout main
          cp README.md /tmp/README.md
          git checkout main
          mv /tmp/README.md README.md
          git commit -am "Sync README.md from README to main" || echo "No changes to commit"
          git push origin main
